<ion-content [fullscreen]="true" class="body">
  <div class="app">
    <div class="mobile-menu md:hidden">
      <div class="mobile-menu-bar">
        <a href="javascript:;" class="flex mr-auto">
          <img
            alt="Logo"
            class="w-6"
            src="/assets/template-admin/dist/images/logo.png"
          />
        </a>
        <a href="javascript:;" id="mobile-menu-toggler">
          <i
            data-feather="bar-chart-2"
            class="w-8 h-8 text-white transform -rotate-90"
          ></i>
        </a>
      </div>
      <ul class="border-t border-theme-24 py-5 hidden">
        <li *ngFor="let item of menuItems">
          <a
            [routerLink]="item.route"
            routerLinkActive="menu--active"
            [routerLinkActiveOptions]="{ exact: true }"
            class="menu"
          >
            <div class="menu__icon">
              <i [attr.data-feather]="item.icon"></i>
            </div>
            <div class="menu__title">{{ item.title }}</div>
          </a>
        </li>
      </ul>
    </div>

    <div class="flex">
      <!-- BEGIN: Side Menu -->
      <nav class="side-nav">
        <a href="javascript:;" class="intro-x flex items-center pl-5 pt-4">
          <img
            alt="Logo"
            class="w-10"
            src="/assets/template-admin/dist/images/logo.png"
          />
          <span class="hidden xl:block text-white text-lg ml-3">
            <span class="font-medium">Medika</span>
          </span>
        </a>
        <div class="side-nav__divider my-6"></div>
        <ul>
          <li *ngFor="let item of menuItems">
            <a
              [routerLink]="item.route"
              routerLinkActive="side-menu--active"
              [routerLinkActiveOptions]="{ exact: true }"
              class="side-menu"
            >
              <div class="side-menu__icon">
                <i [attr.data-feather]="item.icon"></i>
              </div>
              <div class="side-menu__title">{{ item.title }}</div>
            </a>
          </li>
        </ul>
      </nav>
      <!-- END: Side Menu -->
      <!-- BEGIN: Content -->
      <div class="content">
        <!-- BEGIN: Top Bar -->
        <div class="top-bar">
          <div class="-intro-x breadcrumb mr-auto hidden sm:flex"></div>

          <!-- Account Dropdown -->
          <div
            appDropdown
            class="relative inline-block text-left intro-x dropdown w-8 h-8"
          >
            <div
              class="dropdown-toggle w-8 h-8 rounded-full overflow-hidden shadow-lg image-fit zoom-in"
            >
              <img [src]="currentUser.profilePicture" alt="Profile Picture" />
            </div>
            <div
              class="dropdown-box mt-3 absolute left-1 top-full z-20 w-64 -translate-x-1 md:left-auto md:right-0 md:translate-x-0"
              role="menu"
              aria-orientation="vertical"
              aria-labelledby="menu-button"
              tabindex="-1"
            >
              <div class="dropdown-box__content box bg-theme-38 text-white">
                <div class="p-4 border-b border-theme-40">
                  <div class="font-medium">{{ currentUser.name }}</div>
                </div>
                <div class="p-2">
                  <a
                    [routerLink]="['/profile']"
                    class="flex items-center p-2 transition duration-300 ease-in-out hover:bg-theme-1 rounded-md"
                  >
                    <i data-feather="user" class="w-4 h-4 mr-2"></i> Profile
                  </a>
                </div>
                <div class="p-2 border-t border-theme-40">
                  <a
                    (click)="logout()"
                    class="flex items-center p-2 hover:bg-theme-1 rounded-md transition"
                  >
                    <i data-feather="toggle-right" class="w-4 h-4 mr-2"></i>
                    Logout
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- END: Top Bar -->
        <div class="grid grid-cols-12 gap-6">
          <div class="col-span-12 xxl:col-span-9 grid grid-cols-12 gap-6">
            <!-- BEGIN: General Report -->
            <div class="col-span-12 mt-8">
              <div class="intro-y flex items-center h-10">
                <h2 class="text-lg text-gray-700 font-medium truncate mr-5">
                  General Report
                </h2>
                <a href="/dashboard" class="ml-auto flex text-theme-1">
                  <i data-feather="refresh-ccw" class="w-4 h-4 mr-3"></i> Reload
                  Data
                </a>
              </div>

              <div
                class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 mt-5"
              >
                <div class="intro-y">
                  <div class="report-box zoom-in">
                    <div class="box p-5">
                      <div class="flex">
                        <i
                          data-feather="activity"
                          class="report-box__icon text-theme-10"
                        ></i>
                      </div>
                      <div class="text-3xl font-bold leading-8 mt-6">
                        {{ averageCholesterol | number: '1.1-1' }}
                      </div>
                      <div class="text-base text-gray-600 mt-1">
                        Average Cholesterol
                      </div>
                    </div>
                  </div>
                </div>
                <div class="intro-y">
                  <div class="report-box zoom-in">
                    <div class="box p-5">
                      <div class="flex">
                        <i
                          data-feather="credit-card"
                          class="report-box__icon text-theme-11"
                        ></i>
                      </div>
                      <div class="text-3xl font-bold leading-8 mt-6">
                        {{ averageBloodSugar | number: '1.1-1' }}
                      </div>
                      <div class="text-base text-gray-600 mt-1">
                        Average Blood Sugar
                      </div>
                    </div>
                  </div>
                </div>
                <div class="intro-y">
                  <div class="report-box zoom-in">
                    <div class="box p-5">
                      <div class="flex">
                        <i
                          data-feather="monitor"
                          class="report-box__icon text-theme-12"
                        ></i>
                      </div>
                      <div class="text-3xl font-bold leading-8 mt-6">
                        {{ averageUricAcid | number: '1.1-1' }}
                      </div>
                      <div class="text-base text-gray-600 mt-1">
                        Average Uric Acid
                      </div>
                    </div>
                  </div>
                </div>
                <div class="intro-y">
                  <div class="report-box zoom-in">
                    <div class="box p-5">
                      <div class="flex">
                        <i
                          data-feather="calendar"
                          class="report-box__icon text-theme-9"
                        ></i>
                      </div>
                      <div class="text-3xl font-bold leading-8 mt-6">
                        {{ lastUpdate | date: 'dd/MM/yyyy' }}
                      </div>
                      <div class="text-base text-gray-600 mt-1">
                        Last Update
                      </div>
                      <div class="text-3xl font-bold leading-8 mt-6">
                        {{ newDataCount }}
                      </div>
                      <div class="text-base text-gray-600 mt-1">
                        New Data This Week
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- END: General Report -->

            <!-- BEGIN: Health Trends Report -->
            <!-- BEGIN: Health Trends Report -->
            <div class="col-span-12 mt-8">
              <div class="intro-y flex items-center h-10">
                <h2 class="text-lg font-medium truncate mr-5">
                  Health Trends Report
                </h2>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-5">
                <!-- Blood Sugar Chart -->
                <div class="intro-y box p-5">
                  <h3 class="font-medium text-base text-gray-700 mb-4">
                    Blood Sugar
                  </h3>
                  <div class="report-chart">
                    <canvas
                      id="blood-sugar-trend-chart"
                      height="120"
                      class="mt-2"
                    ></canvas>
                  </div>
                </div>

                <!-- Cholesterol Chart -->
                <div class="intro-y box p-5">
                  <h3 class="font-medium text-base text-gray-700 mb-4">
                    Cholesterol
                  </h3>
                  <div class="report-chart">
                    <canvas
                      id="cholesterol-trend-chart"
                      height="120"
                      class="mt-2"
                    ></canvas>
                  </div>
                </div>

                <!-- Uric Acid Chart - full width on all screen -->
                <div class="intro-y box p-5 md:col-span-2">
                  <h3 class="font-medium text-base text-gray-700 mb-4">
                    Uric Acid
                  </h3>
                  <div class="report-chart">
                    <canvas
                      id="uric-acid-trend-chart"
                      height="120"
                      class="mt-2"
                    ></canvas>
                  </div>
                </div>
              </div>
            </div>
            <!-- END: Health Trends Report -->
          </div>
        </div>

        <div class="grid grid-cols-12 gap-6 mt-5">
          <h2 class="intro-y w-64 col-span-6 text-lg font-medium mt-10">
            Data List Layout
          </h2>
          <div class="intro-y col-span-6 flex justify-end items-center mt-2">
            <div class="relative w-64">
              <input
                  type="text"
                  class="input w-full box pr-10 placeholder-theme-13"
                  placeholder="Search..."
                  [(ngModel)]="searchQuery"
                  (input)="onSearchChange()"
                />
              <i
                class="w-4 h-4 absolute my-auto inset-y-0 right-3 text-gray-500"
                data-feather="search"
              ></i>
            </div>
          </div>
          <!-- BEGIN: Data List -->
          <div class="intro-y col-span-12 overflow-auto lg:overflow-visible">
            <table class="table table-report -mt-2">
              <thead>
                <tr>
                  <th class="whitespace-no-wrap">DATE</th>
                  <th class="text-center whitespace-no-wrap">
                    CHOLESTROL (mg/dL)
                  </th>
                  <th class="text-center whitespace-no-wrap">
                    BLOOD SUGAR (mg/dL)
                  </th>
                  <th class="text-center whitespace-no-wrap">
                    URIC ACID (mg/dL)
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of medicalData">
                  <td>{{ item.createdAt.toDate() | date: 'dd/MM/yyyy' }}</td>
                  <td class="text-center">{{ item.kolestrol }}</td>
                  <td class="text-center">{{ item.kadarGula }}</td>
                  <td class="text-center">{{ item.asamUrat }}</td>
                </tr>
                <tr *ngIf="medicalData.length === 0">
                  <td colspan="4" class="text-center text-gray-500">
                    No data available
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- END: Data List -->
          <!-- Pagination -->
          <div class="intro-y col-span-12 flex flex-wrap sm:flex-row items-center">
            <ul class="pagination">
              <li>
                <a class="pagination__link" href="#" (click)="goToPage($event, 1)">
                  <i data-feather="chevrons-left"></i>
                </a>
              </li>
              <li>
                <a class="pagination__link" href="#" (click)="goToPage($event, currentPage - 1)">
                  <i data-feather="chevron-left"></i>
                </a>
              </li>
              <li *ngIf="currentPage > 2">
                <a class="pagination__link" href="#">...</a>
              </li>
              <li *ngFor="let page of pages">
                <a
                  href="#"
                  class="pagination__link"
                  [class.pagination__link--active]="currentPage === page"
                  (click)="goToPage($event, page)"
                >
                  {{ page }}
                </a>
              </li>
              <li>
                <a class="pagination__link" href="#" (click)="goToPage($event, currentPage + 1)">
                  <i data-feather="chevron-right"></i>
                </a>
              </li>
              <li>
                <a class="pagination__link" href="#" (click)="goToPage($event, totalPages)">
                  <i data-feather="chevrons-right"></i>
                </a>
              </li>
            </ul>
            <select class="w-20 input box mt-3 sm:mt-0 ml-auto" [(ngModel)]="itemsPerPage" (change)="updatePagination()">
              <option value="10">10</option>
              <option value="25">25</option>
              <option value="50">50</option>
            </select>
          </div>
          <!-- END: Pagination -->
        </div>
      </div>
      <!-- END: Content -->
    </div>
  </div>
</ion-content>
